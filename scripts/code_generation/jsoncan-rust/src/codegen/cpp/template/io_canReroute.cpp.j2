/**
 * @note This file is auto-generated. Do not modify!
 */
// clang-format off

/* ------------------------------- Includes ------------------------------- */
#include "io_canReroute.hpp"

namespace io::can_reroute {
{%- for bus in node_busses %}
static void (*transmit_func_{{bus.name}})(const JsonCanMsg& tx_msg);
{%- endfor %}
void init(
{%- for bus in node_busses %}
    void (*transmit_func_{{bus.name}}_in)(const JsonCanMsg&) {%- if !loop.last -%}, {%- endif %}
{%- endfor %}
)
{
    {%- for bus in node_busses %}
    transmit_func_{{bus.name}} = transmit_func_{{bus.name}}_in;
    {%- endfor %}
}

{% for from_bus in node_busses %}
void reroute_{{from_bus.name}}(const JsonCanMsg& rx_msg)
{
    switch(rx_msg.std_id)
    {
        {%- for (msg_id, busses) in reroutes.get_forwards_for_bus(from_bus.name) %}
        case app::can_utils::{{ id_macro(msg_id) }}:
        {
            {%- for bus_name in busses %}
            transmit_func_{{bus_name}}(rx_msg);
            {%- endfor %}
            break;
        }
        {%- endfor %}
        default:
            break;
    }
}
{%- endfor %}
}