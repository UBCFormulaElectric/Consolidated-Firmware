# Note: Setting `sudo` to `required` will add 20-50s to CI image boot time
os: linux
dist: trusty
sudo: false
language: python
python: "3.6"

git:
  submodules: false

before_install:
  - ./scripts/travis_ci/pull_git_submodules.sh
  - pip install pipenv
  - git lfs pull

install:
  - pipenv install

addons:
  apt_packages:
    - lib32bz2-1.0
    - lib32ncurses5
    - lib32z1

script:
  - ./scripts/travis_ci/travis_script.sh

matrix:
  include:
    - name: "Build and Run Tests"
      env: RUN_BUILD="true" RUN_TESTS="true"
    - name: "Check Formatting"
      env: RUN_FORMATTING_CHECKS="true"
    - name: "Check STM32CubeMX Code Generation"
      env: RUN_CUBE_CODEGEN_CHECKS="true"
